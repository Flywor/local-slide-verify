(function(t){function e(e){for(var n,o,a=e[0],c=e[1],l=e[2],u=0,d=[];u<a.length;u++)o=a[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);h&&h(e);while(d.length)d.shift()();return r.push.apply(r,l||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],n=!0,a=1;a<i.length;a++){var c=i[a];0!==s[c]&&(n=!1)}n&&(r.splice(e--,1),t=o(o.s=i[0]))}return t}var n={},s={app:0},r=[];function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var h=c;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},2395:function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("SlideVerify",{ref:"slideDiv",attrs:{w:400,h:200},on:{success:t.handleSuccess,fail:t.handleError}})],1)},r=[],o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"slide-verify",attrs:{onselectstart:"return false;"}},[i("div",{staticClass:"slide-verify-refresh-icon",on:{click:t.refresh}},[i("span",{staticClass:"md-refresh"})]),i("canvas",{ref:"canvas",attrs:{width:t.w,height:t.h}}),i("canvas",{ref:"block",staticClass:"slide-verify-block",attrs:{width:t.w,height:t.h}}),i("div",{staticClass:"slide-verify-slider",class:{"container-active":t.containerActive,"container-success":t.containerSuccess,"container-fail":t.containerFail},style:{width:t.w+"px"}},[i("div",{staticClass:"slide-verify-slider-mask",style:{width:t.sliderMaskWidth}},[i("div",{staticClass:"slide-verify-slider-mask-item",style:{left:t.sliderLeft},on:{mousedown:t.handleMouseDown,touchstart:t.handleMouseDown}},[i("span",{staticClass:"arrow-right"})])]),i("span",{staticClass:"slide-verify-slider-text"},[t._v(" "+t._s(t.containerFail?t.failText:t.sliderText)+" ")])])])},a=[],c=(i("99af"),i("cb29"),i("d81d"),i("13d5"),i("a9e3"),Math.PI);function l(t,e){return t+e}function h(t){return t*t}var u={name:"slide-verify",props:{l:{type:Number,default:42},r:{type:Number,default:10},w:{type:Number,default:310},h:{type:Number,default:155},sliderText:{type:String,default:"向右滑动"},failText:{type:String,default:"请重试"}},data:function(){return{containerActive:!1,containerSuccess:!1,containerFail:!1,canvasCtx:null,blockCtx:null,block:null,block_x:void 0,block_y:void 0,L:this.l+2*this.r+3,originX:void 0,originY:void 0,isMouseDown:!1,trail:[],sliderLeft:0,sliderMaskWidth:0}},mounted:function(){this.init()},beforeDestroy:function(){this.handleEvents("remove")},methods:{init:function(){this.initDom(),this.initImg(),this.handleEvents("add")},initDom:function(){this.block=this.$refs.block,this.canvasCtx=this.$refs.canvas.getContext("2d"),this.blockCtx=this.block.getContext("2d")},initImg:function(){this.createImg(),this.drawBlock(),this.blockCtx.drawImage(this.$refs.canvas,0,0,this.w,this.h);var t=this.block_x,e=this.block_y,i=this.r,n=this.L,s=e-2*i-1,r=this.blockCtx.getImageData(t,s,n,n);this.block.width=n,this.blockCtx.putImageData(r,0,s)},drawBlock:function(){this.block_x=this.getRandomNumberByRange(this.L+10,this.w-(this.L+10)),this.block_y=this.getRandomNumberByRange(10+2*this.r,this.h-(this.L+10)),this.draw(this.canvasCtx,this.block_x,this.block_y,"fill"),this.draw(this.blockCtx,this.block_x,this.block_y,"clip")},draw:function(t,e,i,n){var s=this.l,r=this.r;t.beginPath(),t.moveTo(e,i),t.arc(e+s/2,i-r+2,r,.72*c,2.26*c),t.lineTo(e+s,i),t.arc(e+s+r-2,i+s/2,r,1.21*c,2.78*c),t.lineTo(e+s,i+s),t.lineTo(e,i+s),t.arc(e+r-2,i+s/2,r+.4,2.76*c,1.24*c,!0),t.lineTo(e,i),t.lineWidth=2,t.fillStyle="rgba(255, 255, 255, .8)",t.strokeStyle="rgba(255, 255, 255, .8)",t.stroke(),t[n](),t.globalCompositeOperation="xor"},createImg:function(){var t=this.canvasCtx,e=function(t){var e=Math.floor(255*Math.random()),i=Math.floor(255*Math.random()),n=Math.floor(255*Math.random());return"rgba(".concat(e,", ").concat(i,", ").concat(n,", ").concat(t,")")};t.fillStyle=e(.6),t.fillRect(0,0,this.w,this.h);for(var i=0;i<20;i++)t.strokeStyle=e(1),t.lineWidth=3*Math.random(),t.beginPath(),t.moveTo(Math.floor(Math.random()*this.w),Math.floor(Math.random()*this.h)),t.lineTo(Math.floor(Math.random()*this.w),Math.floor(Math.random()*this.h)),t.stroke();for(var n=0;n<20;n++){var s=Math.floor(Math.random()*this.w),r=Math.floor(Math.random()*this.h);t.beginPath(),t.lineWidth=3*Math.random(),t.strokeStyle=e(1),t.arc(s,r,10*Math.random(),2*Math.PI,!1),t.fillStyle=e(1),t.fill(),t.stroke()}},getRandomNumberByRange:function(t,e){return Math.round(Math.random()*(e-t)+t)},refresh:function(){this.reset(),this.$emit("refresh")},handleEvents:function(t){document["".concat(t,"EventListener")]("mousemove",this.handleMouseMove),document["".concat(t,"EventListener")]("mouseup",this.handleMouseUp),document["".concat(t,"EventListener")]("touchmove",this.handleMouseMove),document["".concat(t,"EventListener")]("touchend",this.handleMouseUp)},handleMouseDown:function(t){this.originX=this.getPosition(t,"X"),this.originY=this.getPosition(t,"Y"),this.isMouseDown=!0},handleMouseMove:function(t){if(!this.isMouseDown)return!1;var e=this.getPosition(t,"X")-this.originX,i=this.getPosition(t,"Y")-this.originY;if(e<0||e+38>=this.w)return!1;this.sliderLeft="".concat(e,"px");var n=(this.w-40-20)/(this.w-40)*e;this.block.style.left="".concat(n,"px"),this.containerActive=!0,this.sliderMaskWidth="".concat(e,"px"),this.trail.push(i)},handleMouseUp:function(t){var e=this;if(!this.isMouseDown)return!1;if(this.isMouseDown=!1,this.getPosition(t,"X")===this.originX)return!1;this.containerActive=!1;var i=this.verify(),n=i.spliced,s=i.TuringTest;n?s?(this.containerSuccess=!0,this.$emit("success")):(this.containerFail=!0,this.reset()):(this.containerFail=!0,this.$emit("fail"),setTimeout((function(){e.reset()}),1e3))},getPosition:function(t,e){return t.changedTouches?t.changedTouches[0]["page".concat(e)]:t["client".concat(e)]},verify:function(){var t=this.trail,e=t.reduce(l)/t.length,i=t.map((function(t){return t-e})),n=Math.sqrt(i.map(h).reduce(l)/t.length),s=parseInt(this.block.style.left);return{spliced:Math.abs(s-this.block_x)<10,TuringTest:e!==n}},reset:function(){this.containerActive=!1,this.containerSuccess=!1,this.containerFail=!1,this.sliderLeft=0,this.block.style.left=0,this.sliderMaskWidth=0;var t=this.w,e=this.h;this.canvasCtx.clearRect(0,0,t,e),this.blockCtx.clearRect(0,0,t,e),this.block.width=t,this.initImg()}}},d=u,f=(i("bec5"),i("2877")),v=Object(f["a"])(d,o,a,!1,null,"c683bcee",null),p=v.exports,m={name:"App",components:{SlideVerify:p},data:function(){return{}},methods:{handleSuccess:function(){alert("校验通过")},handleError:function(){alert("校验不通过")}}},b=m,g=(i("7c55"),Object(f["a"])(b,s,r,!1,null,null,null)),y=g.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(y)}}).$mount("#app")},"7c55":function(t,e,i){"use strict";var n=i("2395"),s=i.n(n);s.a},9349:function(t,e,i){},bec5:function(t,e,i){"use strict";var n=i("9349"),s=i.n(n);s.a}});
//# sourceMappingURL=app.218b000d.js.map